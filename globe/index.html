<html>
    <head>
        <title>globe</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.min.js"></script>
        <style>
            html,
            body {
                margin: 0;
                padding: 0;
            }
            body {
                width: 100vw;
                height: 100vh;
                text-align: center;
                background: black;
            }
            canvas {
                image-rendering: -moz-crisp-edges;
                image-rendering: -webkit-crisp-edges;
                image-rendering: pixelated;
                image-rendering: crisp-edges;
            }
        </style>
        <script>
            let camShader;
            let globeDiameterSlider;
            let ringsSlider;
            // let chunkyCheckbox;

            function preload() {
                // load the shader
                camShader = loadShader('./p5assets/treshold.vert', './p5assets/treshold.frag');
            }
            function setup() {
                globeDiameterSlider = createSlider(0, 200, 80);
                globeDiameterSlider.position(10, 10);
                globeDiameterSlider.style('width', '80px');
                ringsSlider = createSlider(0, 5, 1);
                ringsSlider.position(10, 30);
                ringsSlider.style('width', '80px');
                // chunkyCheckbox = createCheckbox('is chunky', false);
                pixelDensity(0.25);
                createCanvas(800, 800, WEBGL);
                pg = createGraphics(800, 800, WEBGL);
            }

            function draw() {
                pg.clear();
                pg.background(0, 0, 0);
                pg.noStroke();

                pg.push();
                pg.rotateY(frameCount * 0.015);
                pg.rotateZ(0.25);
                pg.rotateX(-0.25);
                pg.rotateY(frameCount * 0.01);

                pg.push();
                pg.fill(color(0, 0, 0));
                let globeDiameter = globeDiameterSlider.value();
                pg.sphere(globeDiameter);
                pg.pop();

                pg.push();
                pg.rotateX(0);
                pg.rotateY(0);
                pg.rotateZ(0);
                pg.fill(color(255, 255, 255));
                pg.rotateX(1.5708);
                // let torusDetailY = chunkyCheckbox.checked() ? 40 : 2;
                let torusDetailY = 2;
                let torusCount = ringsSlider.value();
                if (torusCount >= 1) {
                    pg.torus(globeDiameter + 40, 15, 32, torusDetailY);
                }
                if (torusCount >= 2) {
                    pg.torus(globeDiameter + 90, 3, 32, torusDetailY);
                }
                if (torusCount >= 3) {
                    pg.torus(globeDiameter + 110, 4, 32, torusDetailY);
                }
                if (torusCount >= 4) {
                    pg.torus(globeDiameter + 130, 10, 32, torusDetailY);
                }
                pg.pop();

                pg.pop();
                pg.pointLight(250, 250, 250, width/3, height/3, 50);
                noStroke();
                sphere(40);
                shader(camShader);
                camShader.setUniform('tex0', pg);
                rect(0, 0, width, height);
            }
        </script>
    </head>
    <body>

    </body>
</html>